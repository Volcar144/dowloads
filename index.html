<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>File Downloads</title>
  <style>
    /* General Styles for the page */
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(45deg, #f7b7d4, #f9e3d5);
      background-size: 400% 400%;
      animation: gradientAnimation 15s ease infinite;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    /* Animation for the background gradient */
    @keyframes gradientAnimation {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Container that holds all content */
    .container {
      width: 90%;
      max-width: 800px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      gap: 20px; /* Adds space between elements */
    }

    /* Search bar */
    #search {
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    /* File List */
    #file-list {
      list-style: none;
      padding: 0;
    }

    #file-list li {
      background: #f9f9f9;
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    /* File preview styles */
    .file-preview img {
      width: 50px;
      height: auto;
      margin-right: 10px;
    }

    /* Styling the buttons */
    .button-container {
      display: flex;
      justify-content: flex-start;
      gap: 10px;
    }

    .fav-button, .qr-button {
      padding: 8px 12px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 6px;
      border: none;
    }

    .fav-button {
      background-color: #f7b7d4;
      color: white;
    }

    .fav-button:hover {
      background-color: #f58a9c;
    }

    .qr-button {
      background-color: #a2d8f0;
      color: white;
    }

    .qr-button:hover {
      background-color: #6dbbe8;
    }

    /* QR Code Modal */
    .qr-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .qr-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
    }

    #close-qr {
      margin-top: 10px;
      padding: 5px 10px;
      cursor: pointer;
      background: red;
      color: white;
      border: none;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <input type="text" id="search" placeholder="Search for a file...">
    <ul id="file-list"></ul>
  </div>

  <!-- Include QR Code library (e.g., qrcode.min.js) -->
  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const baseFolder = "uploads/";
      const fileList = document.getElementById("file-list");
      const searchInput = document.getElementById("search");

      // Simulate files, replace with actual file names
      const files = {
        jar: ["ChatFilter.jar", "DiscordSRV-Build-1.28.0.jar", "Fadah-Bukkit-2.7.4.jar", "InsaneAnnouncer-1.4.4.jar", "PocketHorses-1.9.6.jar"],
        image: ["download.jpg", "steamuserimages-a.akamaihd.gif"],
        text: ["readme.txt"]
      };

      // Combine all files into a single array for easier filtering
      const allFiles = Object.entries(files).flatMap(([type, fileArray]) =>
        fileArray.map(file => ({ type, file }))
      );

      const favorites = JSON.parse(localStorage.getItem("favorites")) || [];

      // Display files
      function displayFiles(fileArray) {
        fileList.innerHTML = ''; // Clear existing list
        fileArray.forEach(({ type, file }) => {
          const listItem = document.createElement("li");

          const filePath = `${baseFolder}${type}/${file}`;

          // Create the download link
          const link = document.createElement("a");
          link.href = filePath;
          link.download = file;
          link.textContent = `Download ${file}`;

          // Create the favorite button
          const favButton = document.createElement("button");
          favButton.textContent = favorites.includes(file) ? "★" : "☆"; // Star if favorited
          favButton.title = "Add to favorites";
          favButton.classList.add("fav-button");
          favButton.addEventListener("click", () => toggleFavorite(file, favButton));

          // Create the QR code button
          const qrButton = document.createElement("button");
          qrButton.textContent = "QR";
          qrButton.title = "Generate QR Code";
          qrButton.classList.add("qr-button");
          qrButton.addEventListener("click", () => generateQRCode(filePath));

          // Add file preview for images
          if (type === 'image') {
            const preview = document.createElement("div");
            preview.classList.add("file-preview");
            const img = document.createElement("img");
            img.src = filePath;
            img.alt = file;
            preview.appendChild(img);
            listItem.appendChild(preview);
          }

          listItem.appendChild(link);

          // Add buttons inside a container for better alignment
          const buttonContainer = document.createElement("div");
          buttonContainer.classList.add("button-container");
          buttonContainer.appendChild(favButton);
          buttonContainer.appendChild(qrButton);
          listItem.appendChild(buttonContainer);

          fileList.appendChild(listItem);
        });
      }

      // Function to toggle favorites
      function toggleFavorite(file, button) {
        const index = favorites.indexOf(file);
        if (index > -1) {
          favorites.splice(index, 1);
          button.textContent = "☆";
        } else {
          favorites.push(file);
          button.textContent = "★";
        }
        localStorage.setItem("favorites", JSON.stringify(favorites));
      }

      // Function to generate QR Code
      function generateQRCode(url) {
        const qrModal = document.createElement("div");
        qrModal.classList.add("qr-modal");
        qrModal.innerHTML = `
          <div class="qr-container">
            <div id="qr-code"></div>
            <button id="close-qr">Close</button>
          </div>
        `;
        document.body.appendChild(qrModal);

        // Generate the QR Code
        const qrCode = new QRCode(document.getElementById("qr-code"), {
          text: url,
          width: 200,
          height: 200
        });

        // Close button functionality
        document.getElementById("close-qr").addEventListener("click", () => {
          qrModal.remove();
        });
      }

      // Function to filter files based on search
      function filterFiles(query) {
        const filteredFiles = allFiles.filter(({ file }) =>
          file.toLowerCase().includes(query.toLowerCase())
        );
        displayFiles(filteredFiles);
      }

      // Event listener for search input
      searchInput.addEventListener("input", function () {
        const query = searchInput.value;
        filterFiles(query);
      });

      // Initially display all files
      displayFiles(allFiles);
    });
  </script>
</body>
</html>
